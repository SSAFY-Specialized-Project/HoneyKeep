# 서비스 상세 기능 소개서

## 0. 용어 정의 및 개념 설명

### 0.1 포켓(Pocket)의 정의

"포켓"은 사용자가 특정한 목적을 위해 지출을 계획하고 관리하기 위한 가상 자산 지갑입니다. 사용자가 다가오는 소비를 미리 예측하고, 필요한 금액을 미리 분리하여 모아두기 위한 단위로, 마치 실제 지갑에서 지폐를 구분해 보관하는 것처럼 디지털 상에서 자금을 분할 관리할 수 있는 구조입니다.

포켓은 아래의 속성을 가집니다:

- 이름: 사용자가 직접 정하거나 자동으로 생성되는 제목
- 금액: 목표로 하는 지출 금액
- 사용 예정일: 해당 지출이 발생할 것으로 예상되는 날짜
- 카테고리: 동일한 성격의 포켓들을 묶기 위한 분류
- 연결 계좌: 실제 자금을 출금할 계좌
- 상태값:
    - 모으는 중: 아직 목표 금액에 도달하지 않음
    - 모으기 완료: 목표 금액 달성
    - 사용 중: 결제를 위해 일부 혹은 전체 금액이 사용됨
    - 사용 완료: 포켓이 완전히 사용 처리됨

### 0.2 카테고리란?

카테고리는 여러 포켓을 유형별로 분류하는 기능입니다.

카테고리를 통해 사용자는 자신의 소비 계획을 체계적으로 그룹화할 수 있습니다.

예시:

- "정기 구독"
- "여행"
- "식비"
- "건강/의료"

카테고리는 두 가지 방식으로 생성됩니다:

1. 직접 추가: 포켓을 만들 때 직접 이름을 입력하고 아이콘을 선택해 신규 카테고리를 생성
2. 카테고리 관리 메뉴에서 생성, 수정, 삭제 가능

카테고리에는 다음 제약이 존재합니다:

- 이름은 특수문자를 사용할 수 없으며, 한글 또는 영문만 허용됩니다.
- 아이콘은 서비스에서 제공하는 고정형 선택지 중 하나만 선택 가능하며 커스터마이징은 불가합니다.
- 카테고리를 삭제하면, 해당 카테고리에 속해 있는 포켓들도 함께 삭제됩니다.

### 0.3 고정 지출의 정의

고정 지출은 정기적으로 동일 금액이 반복적으로 발생하는 지출 항목을 의미합니다.

주요 특징:

- 반복 주기: 월 1회 발생하는 지출
- 유형: 구독형 서비스(넷플릭스, 유튜브 프리미엄), 통신비, 보험료, 월세 등
- 고정 금액: 대부분 금액이 동일하거나 일정한 패턴을 가짐
- 자동 인식 기능: 사용자의 계좌 거래 내역을 분석하여 반복되는 항목이 일정 패턴으로 감지되면, 시스템이 이를 고정 지출 후보로 자동 추천합니다.

고정 지출은 다음과 같은 상태를 가집니다:

- 발견됨: 시스템이 거래 패턴을 인식해 고정 지출로 제안한 상태
- 등록됨: 사용자가 이를 수락하고 정식 등록한 상태
- 수정됨: 사용자가 금액, 명칭, 시작일 등을 수정한 상태
- 삭제됨: 사용자가 제거한 항목

## 1. 회원가입 및 로그인 기능

### 1.1 회원가입

서비스를 사용하려면 먼저 회원가입 절차를 완료해야 합니다. 이 과정은 다음과 같은 4단계로 구성되어 있습니다:

### 1단계. 사용자 정보 입력 및 약관 동의

- 입력 필드
    - 이름 (한글 2~5자)
    - 생년월일 (8자리: YYYYMMDD)
    - 휴대전화 번호 (숫자만 11자리, 010으로 시작)
- 약관 동의
    - 총 5개의 약관 항목(필수 3개, 선택 2개)
    - "전체 동의" 버튼 존재
    - 각 약관은 클릭 시 팝업으로 상세 내용 열람 가능

### 2단계. 휴대전화 인증

- 전송 방식: 실제 SMS는 전송되지 않으나, 인증번호가 전송된 것처럼 UI 처리
- 입력창 동작
    - 숫자 6자리 제한
    - 입력과 동시에 타이머(3분) 시작
- 예외 처리
    - 타이머 만료 시 입력 불가, 재전송 버튼 활성화
    - 잘못된 인증번호 입력 시 에러 메시지 출력

### 3단계. 이메일 인증

- 입력창 구성
    - 이메일 입력 (형식 자동 검사)
    - 인증번호 입력 필드 + 3분 타이머 표시
- 재전송 기능
    - 인증번호 만료 시, 재전송 버튼이 활성화되어 다시 시도 가능

### 4단계. 비밀번호 설정

- 규칙
    - 정확히 6자리 숫자 (문자, 특수문자 불가)
- UI 처리
    - input type="password"로 입력값 가림
    - 확인 버튼 클릭 시 서버에 비밀번호 암호화 전송

## 1.2 로그인

- 로그인 방식
    - 이메일/휴대폰 + 6자리 비밀번호 입력
- 에러 처리
    - 연속 3회 실패 시, 5분 로그인 제한
    - 실패 시 입력창 아래에 에러 메시지 노출
- 성공 시 동작
    - 사용자 토큰 발급 및 로컬 저장소에 저장
    - 자동 로그인 설정 시, 다음 방문에 인증 유지
    - 로그인 성공 후 메인 페이지로 리디렉션

## 2. 메인 페이지 구조

로그인 후 사용자에게 제공되는 메인 화면은 개인 자산과 포켓 상태를 한눈에 확인할 수 있는 중앙 허브 역할을 합니다.

### 2.1 마이데이터 연결 권유 컴포넌트

- 동작 조건
    - 사용자 금융 계좌가 연결되지 않은 경우만 노출
- 구성 요소
    - 설명 텍스트 + 연결하기 버튼
    - 클릭 시 자산 연결 화면으로 이동
- 상태 변화
    - 하나 이상의 기관과 연결이 완료되면 해당 컴포넌트는 더 이상 표시되지 않음

## 3. 자산 연결하기 (마이데이터 연동)

### 3.1 자산 연결 유도

- 첫 로그인 후 메인 페이지 진입 시, 상단에 자산 연결 유도 배너가 표시됩니다.
- 이 컴포넌트는 사용자가 한 개 이상의 금융기관과 연동을 완료하면 자동으로 사라집니다.
- 배너에는 '지금 연결하기' 버튼이 포함되어 있으며, 클릭 시 연결 화면으로 이동됩니다.

### 3.2 금융기관 선택

- 제공 방식
    - 국내 주요 은행, 카드사, 증권사 목록이 카드 형태로 나열됨
    - 각 금융기관에는 고유 로고와 배경 이미지가 표시됨 (정적 이미지로 클라이언트에 포함)
- 선택 기능
    - 다중 선택 가능
    - '전체 선택' 체크박스를 제공해 한 번에 모든 기관 선택 가능

### 3.3 인증 방식

- 인증 과정
    - 자체 간편인증서 기반의 1원 인증 API 사용
    - 사용자가 인증 동의 → 계좌 접근 권한 요청 → 성공 시 계좌 목록 수신
- 인증 실패 처리
    - 1차 실패: 안내 메시지 출력 + 재시도 유도
    - 2차 실패: 고객센터 연결 안내
- 결과 저장
    - 성공 시, 연결된 기관 목록을 로컬/서버에 저장
    - 이후 계좌 상세 정보가 연동됩니다

## 4. 계좌 상세

### 4.1 계좌 정보

연결된 금융기관의 계좌를 선택하면 아래 정보가 표시됩니다.

- 기본 정보
    - 계좌번호: **-****-**** 형식으로 마스킹
    - 예치금 총액: 실시간 반영
    - 연이율: 소수점 둘째 자리까지 표시
- 거래 내역
    - 거래일자, 상호명, 거래금액(+/-), 잔액, 거래 시간
    - 최신순 정렬
    - 페이지 하단으로 스크롤 시 무한 로딩 방식으로 과거 내역 불러오기
    - 거래 금액 색상: 입금(초록) / 출금(빨강)

### 4.2 이체 기능

- 타 계좌로 송금
    - 이체 대상: 사용자 소유 계좌 or 수동 입력
    - 인증 방식: 비밀번호 재입력 or 간편 인증
    - 이체 가능 시간: 24시간 가능(은행 API 연동 기준 시간 따름)
    - 수수료: 내부 로직에서 표시 (0원~수원에 따라 상이)

## 5. 포켓 생성

포켓은 사용자가 예상되는 지출을 사전에 계획하고, 금액을 지정해 저축 또는 소비할 수 있는 가상 공간입니다. 포켓 생성 방식은 세 가지로 나뉩니다.

### 5.1 링크로 생성하기

- 입력 요소
    - 웹사이트 링크(URL)
    - 사용 예정일 (날짜 선택 가능, null 가능)
    - 출금 계좌
- 동작 과정
    - 입력된 URL을 수집해 HTML 데이터를 서버에 저장
    - 자정 기준으로 GPT 기반 배치 작업 수행
    - HTML 내 상품명/금액/이미지 등을 파싱하여 포켓으로 생성
- 오류 처리
    - 유효하지 않은 링크거나 상품 정보를 추출할 수 없을 경우, 사용자에게 푸시 알림으로 실패 통지
    - 링크 크롤링 후 정보는 확인 및 수정 가능

### 5.2 직접 추가

- 입력 요소
    - 지출명
    - 금액
    - 반복 여부 (예: 매월 1일)
    - 사용 예정일
    - 카테고리 (새로 만들거나 기존 사용)
- 기능 설명
    - 사용 예정일은 선택적이며, 입력하지 않으면 '예정일 없음'으로 표시
    - 카테고리는 사용자 정의 가능, 아이콘은 고정된 선택지 중 하나 선택
    - 반복 지출일 경우, 포켓은 매달 자동 복제되어 생성됨 (예정일 기준)

### 5.3 즐겨찾기에서 불러오기

- 사용 목적
    - 자주 사용하는 지출 항목을 등록해두고, 포켓 생성 시 바로 불러올 수 있음
- 동작 방식
    - 즐겨찾기 항목 클릭 시 입력폼이 자동으로 채워지고, 사용자 수정 후 생성 가능
    - 포켓 생성 화면에 별도 '즐겨찾기 불러오기' 버튼 제공

## 6. 포켓 사용 및 관리

### 6.1 더 모으기

- 기능
    - 기존 포켓에 금액을 추가로 입금함
    - '잔여 금액 채우기' 기능을 제공, 현재까지의 모은 금액 기준으로 자동 계산되어 추천됨
- 출금 방식
    - 포켓 생성 시 지정한 계좌에서 출금됨
    - 계좌 잔액 부족 시 오류 메시지와 함께 실패 처리

### 6.2 사용하기

### 6.2.1 링크가 있는 경우

- 포켓 생성 시 등록한 링크를 클릭해 상품 구매 페이지로 이동
- 해당 상품과 연결된 포켓이 자동 선택됨 (라디오 버튼 선택 상태)
- 사용자는 결제 완료 후 '포켓 사용 완료 처리'를 누름
- 포켓은 상태값이 '사용 완료'로 변경됨

### 6.2.2 링크가 없는 경우

- 사용자는 거래 내역 중 실제 사용된 항목을 선택해 포켓과 매칭 가능
- 매칭되면 해당 거래 내역에 포켓명이 표시됨
- 금액 초과 시 초과분은 연결된 계좌에서 자동 차감

### 6.3 수정하기

- 포켓 상세 페이지에서 '수정' 버튼 클릭
- 포켓명, 금액, 사용 예정일, 카테고리 등 모두 수정 가능
- 단, 출금 계좌 변경 시 현재까지 모은 금액은 초기화(0원) 처리됨

### 6.4 삭제하기

- 포켓 삭제는 상세 페이지에서 수행 가능
- 삭제 시 확인 모달 표시 (취소/확인)
- 포켓이 삭제되면 사용 내역도 함께 사라짐 (히스토리는 남기지 않음)

## 7. 포켓 목록

### 7.1 목록 UI

- 포켓은 카드 형식으로 나열됨
- 각 포켓에는 이미지, 포켓명, 현재 금액, 사용 예정일, 즐겨찾기 여부, 상태 표시가 포함됨

### 7.2 필터/정렬 기능

- 필터링 조건
    - 기간(사용 예정일 범위)
    - 카테고리
    - 상태값: 모으는 중 / 완료 / 사용중 / 사용완료
    - 즐겨찾기 여부
- 정렬 기준
    - 사용 예정일 오름차순
    - 예정일이 없는 포켓은 가장 아래로 정렬
    - 정렬 방식은 고정이며 사용자 커스터마이징 불가
- 검색
    - 포켓 이름으로 실시간 필터 가능

### 7.3 포켓 상세 페이지

- 포켓 클릭 시 모달 팝업 형태로 상세 정보 제공
- 표시 항목
    - 사진, 이름, 분류, 카테고리, 금액, 연결 계좌, 사용 내역
    - 총 금액 / 사용 금액 / 남은 금액
- 사용 이력
    - 포켓과 연결된 거래 내역만 표시
- 버튼
    - 수정, 삭제, 더 모으기, 사용하기
- 즐겨찾기
    - 상단에 별 아이콘 제공 → 클릭으로 토글 가능

## 8. 포켓 캘린더

### 8.1 월 단위 달력 뷰

- 포켓의 사용 예정일 또는 지출 기간을 시각적으로 한눈에 확인할 수 있도록, 월간 캘린더 UI를 제공합니다.
- 각 날짜 셀에 해당 날짜에 시작되거나 사용 예정일이 포함된 포켓을 시각화된 바 형태로 표시합니다.

### 8.2 바 표시 규칙

- 바는 좌우로 길게 뻗어 있으며, 포켓의 기간을 명확히 나타냅니다.
- 한 날짜에 여러 포켓이 겹치는 경우, 최대 3개까지만 시각적으로 노출됩니다.
- 바 색상은 자동 지정되며, 빨강 / 파랑 / 초록 중 랜덤 1색으로 표시됩니다.
- 색상은 동일한 포켓에 대해 한 달간 유지됩니다.

### 8.3 날짜 클릭 시 포켓 목록

- 사용자가 특정 날짜 셀을 클릭하면, 해당 날짜와 관련된 포켓 목록이 리스트 형태로 표시됩니다.
- 리스트에는 아래 정보가 포함됩니다:
    - 포켓 이미지
    - 포켓 이름
    - 사용 예정일
    - 금액
    - 상태
- 포켓을 클릭하면 바로 해당 포켓 상세 모달로 이동합니다.

## 9. 포켓 분석 기능

포켓 분석 기능은 사용자의 소비 습관을 데이터 기반으로 파악하고, 패턴을 제공하며, 소비 인사이트를 제공합니다.

### 9.1 분석 단위

- 주간 (일요일 ~ 토요일)
- 월간 (1일 ~ 말일)
- 연간 (1월 ~ 12월)

기본적으로는 현재 날짜 기준의 주/월/연이 선택되며, 이전/다음 주기별 데이터로 이동할 수 있는 네비게이션 버튼이 존재합니다.

### 9.2 제공 항목

- 소득 대비 지출 비율
    - 연결된 계좌의 수입 항목 기준으로 계산
    - 예: “이달 소득 300만원, 지출 포켓 총합 180만원 → 60%”
- 지출 밸런스
    - 카테고리별 지출 금액 비중을 원형 차트로 시각화
    - 예: 식비 30%, 정기 구독 25%, 교통비 15% …
- 월간 지출 패턴
    - 달력 형태로 실제 지출이 발생한 날짜별 금액을 표시 (Heatmap 스타일)

## 10. 고정 지출

고정 지출은 서비스에서 가장 핵심적인 반복 지출 관리 기능 중 하나로, 사용자의 정기적 지출을 체계적으로 추적하고 관리합니다.

### 10.1 고정 지출 목록

- 고정 지출은 전용 관리 페이지에서 전체 목록을 볼 수 있습니다.
- 상단에 이번 달 기준:
    - 등록된 고정 지출 개수
    - 총 예상 지출 금액
- 각 고정 지출 항목은 카드 형태로 표현되며, 아래 항목을 포함합니다:
    - 서비스명 (예: 넷플릭스, KT 통신)
    - 금액
    - 시작일
    - 다음 결제일
    - 메모 (선택 사항)

### 10.2 고정 지출 추가

- 수동 추가 방식
    - 서비스명, 금액, 시작일, 결제 주기(기본 월 1회), 메모를 직접 입력
- 저장 시, 지정한 날짜 기준으로 향후 결제일을 자동 계산
- 각 고정 지출은 분석 및 리마인드 기능에 자동 반영됩니다

### 10.3 고정 지출 자동 발견

- 사용자 계좌의 거래 내역을 분석하여, 일정 주기(예: 매달 10일)에 동일 상호명 + 유사 금액이 반복되면 자동으로 고정 지출 후보로 감지합니다.
- 감지 조건:
    - 동일한 상호명
    - ±10% 이내 금액 변화
    - 월 1회 이상 반복
- 발견 시 알림으로 사용자에게 알려주며, 3가지 행동을 유도합니다:
    1. 수용 → 고정 지출로 등록
    2. 삭제 → 해당 패턴 무시
    3. 수정 → 사용자가 직접 보정

### 10.4 고정 지출 관리

- 기존 고정 지출 항목을 선택하면 수정 화면이 뜨며, 아래 항목을 수정할 수 있습니다:
    - 서비스명
    - 금액
    - 시작일
    - 다음 결제일
    - 메모
- 삭제 기능도 함께 제공되며, 삭제 시 확인 모달이 표시됩니다.

## 11. 알림 설정

### 11.1 사용자 알림 ON/OFF 설정

- 사용자가 직접 알림을 개별적으로 설정/해제할 수 있는 옵션을 제공합니다.

### 설정 가능한 알림 항목:

1. 지출 예정일 리마인드
    - 사용 예정일 하루 전 오전 9시에 푸시 알림 전송
2. 비활성 포켓 감지
    - 사용자가 생성했지만 3일 이상 아무런 작업이 없는 포켓에 대해 알림
3. 계좌 잔액 경고
    - 연결된 계좌의 총액이 포켓 전체 금액보다 적을 경우, 초과 가능성 경고
4. 하루 한 번 사용처리 유도
    - 하루에 한 번, ‘오늘 지출을 포켓에 반영하셨나요?’ 메시지

### 11.2 필수 알림 (앱 알림 꺼도 유지됨)

- 아래 항목은 앱 내에서 꺼도 푸시 전송이 유지됩니다:
1. 자체페이 결제 진행
2. 현장 결제 (QR 결제)

이 항목들은 실시간 결제 흐름이 포함되므로 반드시 사용자에게 전달되어야 합니다.

## 12. AI 챗봇

서비스에는 간단한 AI 챗봇 기능이 포함되어 있으며, 사용자는 자유롭게 질문을 통해 도움을 받을 수 있습니다.

### 12.1 기능 범위

- 기능 설명: 예) “포켓은 어떻게 써요?”
- 포켓 추천: 예) “여행 포켓 만들고 싶은데 추천해줘”
- 설정 안내: 예) “알림 끄는 방법 알려줘”
- 고정 지출 등록 도우미

### 12.2 답변 방식

- OpenAI 기반의 GPT 모델을 이용하여 질의응답을 수행
- 챗봇 인터페이스는 메신저 스타일
- 특정 질문은 버튼 또는 링크로 유도되며, 입력 폼으로 직접 연결

## 총정리

이 서비스는 사용자에게 다음과 같은 경험을 제공합니다:

- 지출 계획을 시각화하고 제어할 수 있는 구조적 소비 관리 도구
- 미래 지출을 예측하고 대비하기 위한 포켓 기능
- 반복적인 지출을 통합 관리하는 고정 지출 시스템
- 거래 기반의 스마트 분석과 캘린더 시각화
- 편리한 자산 연결과 인증 기반의 금융 정보 수집
- 알림, 챗봇, 자동화된 인사이트까지 갖춘 금융 습관 보조 시스템