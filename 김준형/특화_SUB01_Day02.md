# Nginx

---

## 1. Nginx 개요

- **정의 및 역할:**
    
    Nginx는 주로 웹 서버, 리버스 프록시, 로드 밸런서, 그리고 HTTP 캐시 서버로 사용된다. 빠른 성능, 낮은 메모리 사용량, 높은 동시 접속 처리 능력으로 유용하다.
    
- **주요 사용처:**
    - 정적 파일 서비스
    - 리버스 프록시 및 API 게이트웨이
    - 부하 분산(로드 밸런싱)
    - SSL/TLS 종료
    - 캐싱 및 콘텐츠 압축
- **이유**
    - 대규모 트래픽 환경에서 요청을 효율적으로 처리하기 위해 사용된다.

## 2. Nginx의 아키텍처

- **이벤트 기반 비동기 처리 모델:**하나의 워커 프로세스가 수천 건의 연결을 동시에 관리할 수 있다.
    - **이유:** 리소스를 효율적으로 사용하며 많은 요청을 동시에 처리할 수 있다.
- **멀티 프로세스 구조:**마스터 프로세스와 여러 워커 프로세스로 구성되어 있다.
    - **이유:** 하나의 워커에 문제가 생겨도 전체 서비스에 영향을 주지 않도록 설계되어 있다.

## 3. Nginx의 주요 기능 및 활용

### 3.1. 웹 서버 역할

- **정적 콘텐츠 제공:**이미지, HTML, CSS, JavaScript 파일 등을 빠르게 제공한다.
- **이유:**사용자에게 빠른 응답을 주고, 백엔드 서버의 부하를 줄이기 위해 사용된다.

### 3.2. 리버스 프록시 & 로드 밸런서

- **리버스 프록시:**클라이언트의 요청을 백엔드 서버로 전달한다. 보안, SSL 종료, 캐싱 등의 추가 기능도 제공한다.
- **로드 밸런서:**라운드 로빈, IP 해시, 가중치 기반 분산 알고리즘 등을 사용해 요청을 여러 서버에 분산시킨다.
- **헬스체크:**백엔드 서버의 상태를 주기적으로 확인해 문제가 있는 서버로 요청이 전달되지 않게 한다.
- **이유:**서버 간 트래픽 분산과 장애 발생 시 자동 대응을 위해 활용된다.

### 3.3. 캐싱

- **캐싱 및 압축:**정적 및 동적 콘텐츠를 캐싱하고, gzip 압축을 통해 데이터 크기를 줄인다.
- **이유:**응답 속도를 높이고 네트워크 대역폭 사용을 줄여 서버 효율성을 향상시키기 위해 사용된다.

### 3.4. 보안 기능

- **SSL/TLS 종료:**암호화된 HTTPS 요청을 처리해 백엔드 서버 부하를 줄인다.
- **접근 제어:**IP 접근 제한이나 요청 제한 같은 기능으로 보안을 강화한다.
- **URL 리라이트 및 리디렉션:**요청을 적절히 관리해 보안을 강화하고 사용자 경험을 개선한다.
- **이유:**서버를 외부 공격으로부터 보호하고, 안전한 데이터 전송을 보장하기 위해 사용된다.

# Apache VS Nginx

### 1. 요청 처리 방식

- **Apache:**
    
    Apache는 요청이 들어올 때마다 각각의 요청을 처리하기 위해 별도의 프로세스나 스레드를 생성하는 모델을 사용한다.
    
    - **프로세스:** 독립적으로 실행되는 프로그램 단위이다.
    - **스레드:** 하나의 프로세스 내에서 동시에 여러 작업을 수행할 수 있는 실행 단위이다.Apache는 Multi-Processing Module(MPM)을 통해, 프로세스 기반(예: prefork) 또는 스레드 기반(예: worker, event) 모델을 선택할 수 있다.
    - **장점:** 각 요청이 독립적으로 처리되므로 모듈 확장이 용이하고 안정성이 높다.
    - **단점:** 요청이 많아지면, 각 요청마다 새로운 프로세스나 스레드를 생성하기 때문에 CPU와 메모리 같은 시스템 자원 소비가 증가할 수 있다.
- **Nginx:**
    
    Nginx는 이벤트 기반의 비동기 처리 모델을 채택한다.
    
    - **이벤트 기반의 비동기 모델:** 프로그램이 동시에 여러 작업(예: 클라이언트의 요청)을 처리할 때, 하나의 실행 흐름(이벤트 루프)을 사용하여 작업이 준비되었거나 완료된 시점에만 실행하도록 하는 방식. 한 이벤트 루프가 준비된 작업만 처리하여, 기다리는 동안 다른 작업을 동시에 수행함으로써 효율적인 자원 사용과 빠른 응답을 가능하게 한다.
    - **비동기 처리:** 하나의 작업이 완료되길 기다리지 않고 다른 작업을 동시에 처리할 수 있다.
    - **워커 프로세스:** Nginx는 미리 소수의 워커 프로세스를 생성해, 각 워커가 이벤트 루프를 통해 다수의 요청을 비동기적으로 처리한다. Nginx는 마스터 프로세스가 여러 개의 워커 프로세스를 미리 생성하고, 각 워커 프로세스가 자체의 이벤트 루프를 돌며 다수의 요청을 동시에 처리한다.
    - **장점:** 소수의 프로세스 내에서 수많은 연결을 효율적으로 관리할 수 있어, 메모리와 CPU 사용량이 적고 높은 동시 접속 환경에서도 우수한 성능을 유지한다.

### 2. 시스템 자원 효율성

- **Apache:**각 요청마다 새로운 프로세스나 스레드가 생성되므로, 동시 요청이 많아지면 시스템 자원의 사용량이 급증할 수 있다.
    - **적용 상황:** 요청 수가 상대적으로 적거나, 복잡한 모듈 구성이 필요한 경우에 유리하다.
- **Nginx:**이벤트 기반 모델로 단일 또는 소수의 워커 프로세스가 다수의 요청을 관리하기 때문에, 시스템 자원을 효율적으로 사용한다.
    - **적용 상황:** 높은 트래픽과 다수의 동시 연결을 요구하는 환경에서 성능과 확장성이 뛰어나다.

### 결론

- **Apache는** 각 요청마다 별도의 프로세스나 스레드를 생성하여 처리하는 방식으로, 복잡한 기능 확장이 가능하지만, 동시 요청이 많을 경우 자원 소모가 크다.
- **Nginx는** 이벤트 기반의 비동기 모델을 사용해 소수의 워커 프로세스가 다수의 요청을 효율적으로 처리하므로, 높은 동시 접속 처리 능력과 자원 효율성이 뛰어나다.